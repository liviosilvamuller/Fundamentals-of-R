---
title: "Visualizing Data"
subtitle: "Fundamentals of R Workshop - Homework 3"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Documents/GitHub/Fundamentals_of_R_IHEID2022/Fundamentals_workshop_2023/Lecture_4_homework")
phd_theses <- readRDS("phd_theses.Rds")
library(ggplot2)
library(dplyr)
```

-   All materials for the exercises below are available in the homework folder on Moodle.
-   Please submit your answers as an HTML or a PDF file generated with Rmarkdown. Please make sure to include code chunks and plots in submited the document.

*Tip: Adding titles, legends, and themes to your plots helps us help you!*

# Ph.D. theses at the Graduate Institute III

The Institute has been the home for hundreds of PhD students over time. In this homework, we will visualize data to investigate how PhD theses at the Institute relate to gender and sustainability topics. The dataset contains the following variables:

| Name                | Description                                          |
|:-----------------------|:----------------------------------------------|
| `thesis_title`      | Title of the Ph.D. thesis.                           |
| `thesis_ID`         | ID of the Ph.D. thesis.                              |
| `thesis_year`       | The year in which a thesis was submitted.            |
| `thesis_author`     | The author of the thesis.                            |
| `thesis_department` | Department in which the thesis was written.          |
| `thesis_language`   | Language in which the thesis was written.            |
| `sus_degree`        | Extent to which theses covers sustainability topics. |
| `gen_degree`        | Extent to which theses covers gender-related topics. |

## Question 1

Let's use plots to investigate the data.

a) Plot a histogram showing the distribution of PHD thesis over time (Tip: you could use base R here, see `?hist`). Why do you think we had so few thesis defenses in 2020 in comparison with previous years?

```{r, include=FALSE}
hist(phd_theses$thesis_year)
```


b) Plot various histograms side-by-side showing the distribution of PHD thesis over time for each department (Tip: use `geom_histogram()` and facet wrap the histograms by 'thesis_department').

```{r, include=FALSE}
ggplot(phd_theses) +
  geom_histogram(aes(thesis_year)) +
  facet_wrap('thesis_department')
```

## Question 2

a) Do we have any NA values in the data? Please replace any NA values in the 'sus_degree' and 'gen_degree' variables with the value of 0.

```{r, include=FALSE}
phd_theses <- mutate(phd_theses,
                     sus_degree = ifelse(is.na(sus_degree), 0, sus_degree),
                     gen_degree = ifelse(is.na(gen_degree), 0, gen_degree))
```

b) Please plot, in the same plot, a comparison of how the extend to which theses covers sustainability and gender topics changed over time (Tip: to smooth your lines to facilitate visualization, see `?geom_smooth`). Do you think the increase in these topics correlate?

```{r, include=FALSE}
ggplot(phd_theses) +
  geom_smooth(aes(x = thesis_year, y = sus_degree), color = "green") +
  geom_smooth(aes(x = thesis_year, y = gen_degree), color = "blue")
```

## Question 3

a) Create a bar plot displaying the total number of theses written in each department. Please color the bars by the mean sustainability score (Tip: you can use `group_by()` and `summarise()` to wrangle the data before plotting). Is this a good visualization?

```{r, include=FALSE}
phd_theses %>%
  group_by(thesis_department) %>%
  summarise(count = n(),
            mean_sustainability = mean(sus_degree)) %>% 
  ggplot(aes(x = thesis_department, y = count, fill = mean_sustainability)) +
  geom_col()
```

b) Please color the same bar plot, as above (2a), by the mean gender score. How could you improve this visualization?

```{r, include=FALSE}
phd_theses %>%
  group_by(thesis_department) %>%
  summarise(count = n(),
            mean_gender = mean(gen_degree)) %>% 
  ggplot(aes(x = thesis_department, y = count, fill = mean_gender)) +
  geom_col()
```

## Question 4

Has the extent to which PhD theses cover sutainability and gender topics increased over time across all departments? Please illustrate this relationship in a line plot, colored by the respective departments.

```{r}
phd_theses %>%
  
```


## Question 5

Plot the distribution for all thesis written before the year 2000, and after the year 2000, comparing the language they were written in (Tip: box plots are great for distributions).

```{r}

```

## Question 6

a) Create a scatter plot containing all thesis over time. The points should be colored by department.

```{r}
phd_theses %>%
  group_by(thesis_year, thesis_department) %>%
  summarise(sum = n()) %>%
  ggplot(aes(x = thesis_year, y = sum, fill = thesis_department)) +
  geom_point(aes(color = thesis_department))
```


b) Create various scatter plots, one for each department, containing all thesis over time. Please shape the points as squares if their sustainability score is bigger than 1 or as a triangle if their gender score is bigger than one (Tip: `facet_wrap()` will help you with the multiple plots and you can use the shape argument in `geom_point()`).

```{r}
phd_theses %>%
  
```
