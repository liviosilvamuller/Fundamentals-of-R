---
title: 'Objects, class and data structures'
subtitle: 'Fundamentals of R Workshop - Homework 1'
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
phd_theses <- readRDS("~/Documents/GitHub/Fundamentals_of_R_IHEID2022/Fundamentals_workshop_2023/Lecture_2_homework/_2/phd_theses.rds")
```

```{r prep, message=FALSE, warning=FALSE, include=FALSE}
# library(tidyverse)
# phd_theses <- readRDS("~/Documents/GitHub/Fundamentals_of_R_IHEID2022/Fundamentals_workshop_2023/Lecture_2_homework/_2/cleaned_phd_theses.rds")
# phd_theses$year<-as.character(phd_theses$year)
# phd_theses <- phd_theses %>% rename(sus_degree=sust, gen_degree=gen)
# phd_theses$gen_degree<-as.character(phd_theses$gen_degree)
# phd_theses <- as.data.frame(phd_theses)
# saveRDS(phd_theses,file="~/Documents/GitHub/Fundamentals_of_R_IHEID2022/Fundamentals_workshop_2023/Lecture_2_homework/_2/phd_theses.rds")
```

-   All materials for the exercises below are available in the homework folder on Moodle.
-   Please submit an R script containing both the code and results on Moodle.
-   For each question, please do not forget to include the code used to find the answer.
-   You can #comment out any sentences that are part of your answers but are not R code.

# PhD theses at the Graduate Institute

The Institute has been the home for hundreds of PhD students over time. In this homework, we will data about PhD theses at the Institute. Please download and load the "phd_theses" from the course Moodle page. It looks like this:

| Name                | Description                                                                                          |
|:------------------------|:----------------------------------------------|
| `title`      | Title of the Ph.D. thesis.                                                                           |
| `year`       | The year in which a thesis was submitted.                                                            |
| `author`     | The author of the thesis.                                                                            |
| `department` | Department in which the thesis was written.                                                          |
| `language`   | Language in which the thesis was written.                                                            |
| `sus_degree`        | Extent to which theses covers sustainability topics.                                                 |
| `gen_degree`        | Extent to which theses covers gender-related topics.                                                 |
| `complete_series`   | Takes the value TRUE, if observation belongs to a year when all current departments already existed. |

## Question 1

a)  What data structure is "phd_theses"?

b)  Create a new vector called title that contains the title column from the phd_theses dataset.

```{r, include=FALSE}
title<- phd_theses$title
str(title)
```

c)  How many observations does the dataset have?

```{r, include=FALSE}
names(phd_theses)
ncol(phd_theses)
```

d)  How many variables does the dataset have?

```{r, include=FALSE}
summary(phd_theses)
nrow(phd_theses)
```


## Question 2

a)  What is the class of the year variable in the dataset?

```{r, include=FALSE}
class(phd_theses$year)
```

b)  Please convert the year variable to numeric.

```{r, include=FALSE}
phd_theses$year <- as.numeric(phd_theses$year)
```

## Question 3

a)  How many PhD theses were written in 1930?

```{r, include=FALSE}
subset(phd_theses, year ==2015)
```

b)  Did World War II (1939-1945) affect the number of theses written? Calculate the difference between the number of theses written in the seven years before the war and the seven years during the war.

```{r, include=FALSE}
nrow(subset(phd_theses, year >1931 & year <1939))-
  nrow(subset(phd_theses, year >1938 & year <1946))
```

## Question 4

a)  What is the mean for the variable `sus_degree`?

```{r, include=FALSE}
mean(phd_theses$sus_degree, na.rm=TRUE)
```

b)  What about the mean for the variable `gen_degree`?

```{r, include=FALSE}
phd_theses$gen_degree <- as.numeric(phd_theses$gen_degree)
mean(phd_theses$gen_degree, na.rm=TRUE)
```

c) Please create logical tests comparing the mean of both variables and interpret the results.

```{r, include=FALSE}
mean(phd_theses$sus_degree, na.rm=TRUE) < mean(phd_theses$gen_degree, na.rm=TRUE)
```

## Question 5

a)  How many PhD theses were written in the International Relations/Political Science program?

```{r, include=FALSE}
nrow(subset(phd_theses, department == "IRPS"))
```

b)  What is the median year for PhD theses written in the International Relations/Political Science program?

```{r, include=FALSE}
IRPS <- subset(phd_theses, department == "IRPS")
median(IRPS$year)
```

## Question 6

a)  How many PhD theses were written in each program ? Which department has been the most productive?

```{r, include=FALSE}
summary(factor(phd_theses$department))
```

a)  Some programs are older than others, for example, the ANSO department just turned 10 years while the IRPS department has existed for at least thirty. Subset the dataset to contain only observations for which `complete_series` is true, and count again the number of theses per department.

```{r, include=FALSE}
dat <- subset(phd_theses, complete_series == "TRUE")
summary(factor(dat$department))
```

b)  A lot of PhD theses do not have a department specified and are categorized as "other". Could you please change this category within the program variable to "Not Available" (hint: brackets can help here and you can find help [here](https://stackoverflow.com/questions/5824173/replace-a-value-in-a-data-frame-based-on-a-conditional-if-statement)).

```{r, include=FALSE}
phd_theses$department[phd_theses$department == "Other"] <- "Not Available"
summary(factor(phd_theses$department))
```

## Question 7

a)  Suppose you wanted to know how many PhD theses were written about development, generally. Please select all the PhD theses that contain the word "development" in their title (hint: ´grep()´ could help you here).

```{r, include=FALSE}
grep("development", phd_theses$title)
phd_theses[grep("development", phd_theses$title),]
```

b)  Please create a new variable in the dataset called "about_development" with the value of 1 if the title of the PhD thesis contains the word "development" or the value 0 if the PhD title does not contain the word "development" (hint: ´grepl()´ and ´ifelse()´ can help).

```{r, include=FALSE}
phd_theses$about_development <- ifelse(grepl("development", phd_theses$title), 1, 0)
```

c)  How many PhD theses that have the word "development" in their title were written before the year 2000? What about after the year 2000 (hint: ´subset()´ accepts multiple conditions)? Please also add a sentence interpreting these results.

```{r, include=FALSE}
subset(phd_theses, about_development == 1 & year < 2000)
subset(phd_theses, about_development == 1 & year > 2000)
```

## Question 8

For the PhD theses at the Institute, candidates often have the choice of writing multiple essays or a manuscript. Suppose you are interested in their format, how many PhD theses contain the words "essay" or "essays" in their title and were written in the International Economics or Development Economics programs (hint: you can use ´subset()´ with ´grepl()´)?

```{r, include=FALSE}
subset(phd_theses, grepl("essay|essays", phd_theses$title) & 
         grepl("IE",
               phd_theses$department))
```

## Bonus Question

Please create a new dataset aggregating all PhD theses' titles by their program. The new dataset should have two columns, one called "program" with the PhD theses program and the other called "titles" with all the titles pasted together. The new dataset should have 12 rows, one for each program. Please use ´aggregate()´ and ´paste()´ to accomplish this (hint: use the practical script for reference and find help [here](https://stackoverflow.com/questions/61082463/set-collapse-for-paste-function-in-aggregate)).

```{r, include=FALSE}
phd_theses_aggregated <- aggregate(phd_theses$title,
                                   list(phd_theses$department),
                                   FUN = paste, collapse= ",")
```
