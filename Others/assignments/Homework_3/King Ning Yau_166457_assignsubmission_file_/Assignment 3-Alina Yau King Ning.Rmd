---
title: "Assignment 3"
output: html_document

Homework Block 3
Yau King Ning, Alina
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library("readr")
library("ggplot2")
library("dplyr")
library("tidyr")
library(ggthemes) 
```

```{r}
knitr::opts_chunk$set(echo = TRUE)
io_income <- read_csv("io_income_rs.csv")
```


#Question 1:
Create a bar plot displaying the top 10 overall donors and their total donations to all international organizations. Please color the donors by their type (i.e. public or private).

```{r}
io_income %>% # select data
  drop_na(donor) %>%
  group_by(donor,type_donor) %>%
  summarise (amount=sum(amount_nominal)) %>%
  arrange(-amount) %>%
  head (10) %>%
ggplot(aes(x=donor, y=amount,
           fill = as.factor(type_donor))) +
  geom_col(position="dodge")+
   labs(title = "Top 10 Donors", 
       x = "Amount", 
       y = "Donor", 
       fill = "Type of donor")
```


#Question 2:
Has the amount the US donates to all issue areas increased over time? Please illustrate this relationship in a line plot, colored by the respective issue areas.

- No, not all issue areas that US donates has increased over time.

```{r}
io_income %>% 
  filter(donor=="United States") %>%
  group_by(issue_area,year) %>%
  summarise (yeartotal=sum(amount_nominal)) %>%
  ggplot(aes(x=year, y=yeartotal,color=issue_area)) +
  geom_line()+
  ggtitle("US Donation in Different Areas")+
  ylab("Donation Amount")+
  scale_y_continuous(labels=scales::comma)
```


#Question 3:
Plot the distribution of all donations in the year 2000 and in the year 2020 comparing public and private donors. Are there outliers for either of these types of donors in 2000? What about in 2020? (Tip: box plots are great for distributions! Please treat year as factor and scale the nominal amount using “scale_y_log10(labels = scales::dollar)”).

- Yes, there are outliers for private donors in 2000, and there are outliers for both private and  public donors in 2020.

```{r}
#Boxplot for 2000
io_income %>% 
  filter(year == 2000) %>%
  ggplot(aes(x = type_donor, y = amount_nominal, fill=type_donor))+
  geom_boxplot() +
    labs(title = "Donations in 2000", 
       x = "Type of Donor", 
       y = "Donation") +
  scale_y_log10(labels = scales::dollar)

#Boxplot for 2020
io_income %>% 
  filter(year == 2020) %>%
  ggplot(aes(x = type_donor, y = amount_nominal, fill=type_donor))+
  geom_boxplot() +
    labs(title = "Donations in 2020", 
       x = "Type of Donor", 
       y = "Donation") +
  scale_y_log10(labels = scales::dollar)
```


#Question 4
Create four scatter plots, one for each issue area, containing all donation by year per donor type (Tip: use “facet_wrap(~issue_area)”). The shape of the points should reflect the donor type (Tip: use “geom_point(aes(shape = donor_type”))“). In each facet, please add a smoothed line to show the direction of the relationship (TIP: use”geom_smooth()“). The smoothed lines should be colored”red”.

```{r}
io_income %>% 
  group_by(issue_area) %>%
  
  ggplot(aes(x = year, y = amount_nominal, shape=type_donor))+
    facet_wrap(~issue_area)+
  geom_point(aes(shape = type_donor, color= type_donor))+
  geom_smooth(se=FALSE, color="red", na.rm=TRUE,method=lm,size=0.2)+
labs(title = "Donation by year in different issue areas",
       x = "Years", 
       y = "Donation amount")+
  scale_x_log10() +
  theme_fivethirtyeight()
```
